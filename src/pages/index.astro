---
	import Layout from '../layouts/Layout.astro';
	import client from '../umbraco-client';

	const { name } = await client.getContentById('b88184e3-f5ed-49fa-a30f-27c8f694773e').then(res => res);
	const { title, description } = await client.getContentById('b88184e3-f5ed-49fa-a30f-27c8f694773e').then(res => res.properties);
	const pages = await client.getContentByType('page', { sort: { type: 'createDate', order: 'asc' }})
	const newsposts = await client.getContentByType('news', { sort: { type: 'createDate', order: 'asc' }})

	const allRoutes = [...pages,...newsposts];
// 1063
// b88184e3-f5ed-49fa-a30f-27c8f694773e
	function getUmbracoImage(image) {
		if (!image) return;
		const { url } = image[0]
		return `https://1235738-www.web.tornado-node.net${url}`;
	}
---

<Layout {title} {description}>
	{JSON.stringify(name,null,1)}
	<h1>{title}</h1>
	<p>{description}</p>
	<div class="card-grid">
		{allRoutes.map(post => {
			const { title, description, image } = post.properties;
			const { path } = post.route
			return (
				<a href={`${path}`} class="card">
					{post.route.path}
					<img src={getUmbracoImage(image)} alt="" class="card-image" />
					<div class="card-content">
						<h2>{title}</h2>
						<p>{description}</p>
					</div>
				</a>
			);
		})}
	</div>
</Layout>

<style>
	.card-grid {
		display: grid;
		grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
		grid-gap: 1rem;
	}

	.card {
		background: white;
		color: #13151a;
		text-decoration: none;
	}

	.card-image {
		width: 100%;
		height: 250px;
		object-fit: cover;
	}

	.card-content {
		padding: 1rem;
	}
</style>
